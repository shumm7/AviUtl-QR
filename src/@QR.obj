@QR
--track0:サイズ,1,256,5
--track1:誤り訂正,1,4,2,1
--track2:最小Ver,1,40,1,1
--track3:最大Ver,1,40,40,1
--dialog:テキスト,local text="aviutl";色1/col,local col1="0xffffff";色2/col,local col2="0x000000";マスク[-1-7],local mask=-1;Boost ECC/chk,local boost=1;

local tm = require("textmodule")
local size = obj.track0
local dotdrawer_dir = obj.getinfo("script_path").."dotdrawer.lua"
local dotdrawer

-- textmoduleのバージョンチェック
if textmodule.getinfo("version", 2)<25 then
	return
end

-- dotdrawer 読み込み処理
local function download()
  tm.fs.write(dotdrawer_dir,
    tm.http.get("https://raw.githubusercontent.com/shumm7/AviUtl-dotdrawer.lua/main/src/dotdrawer_u8.lua")
  )
  return
end

if (not tm.fs.exists(dotdrawer_dir)) then
  return download()
end
if(pcall(dofile(dotdrawer_dir))) then
  return download()
end
dotdrawer = dofile(dotdrawer_dir)

-- QRコード生成
local tab = tm.qrcode.encode(text, obj.track1, obj.track2, obj.track3, mask, 1==boost)
for x=1,#tab do
    for y=1,#tab[x] do
        if tab[x][y] then
            tab[x][y] = col2
        else
            tab[x][y] = col1
        end
    end
end

-- 描画
dotdrawer.draw_dots(tab, size)
